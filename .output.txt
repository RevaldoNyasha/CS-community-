
  ..⨯⨯⨯....⨯⨯.⨯⨯.⨯⨯⨯⨯⨯..⨯⨯.⨯⨯.........⨯⨯⨯⨯.⨯⨯⨯⨯⨯⨯⨯...⨯⨯⨯...⨯⨯.⨯⨯...⨯⨯⨯⨯⨯⨯⨯⨯⨯⨯.
  ⨯⨯⨯⨯⨯.⨯⨯.⨯⨯⨯⨯.⨯⨯⨯⨯⨯⨯..
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminAnnouncementTest > admin can create an a…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Admin\AdminAnnouncementTest.php:22
     18▕         ->post('/admin/announcements', [
     19▕             'title' => 'System Update',
     20▕             'content' => 'The system will be down for maintenance.',
     21▕         ])
  ➜  22▕         ->assertRedirect();
     23▕
     24▕     $this->assertDatabaseHas('posts', [
     25▕         'title' => 'System Update',
     26▕         'type' => 'announcement',
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminAnnouncementTest > admin can delete an a…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Admin\AdminAnnouncementTest.php:38
     34▕     $post = Post::factory()->approved()->announcement()->create(['user_id' => $admin->id]);
     35▕
     36▕     $this->actingAs($admin)
     37▕         ->delete("/admin/announcements/{$post->id}")
  ➜  38▕         ->assertRedirect();
     39▕
     40▕     $this->assertDatabaseMissing('posts', ['id' => $post->id]);
     41▕ });
     42▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminAnnouncementTest > non-admin cannot crea…
  Expected response status code [403] but received 419.
Failed asserting that 419 is identical to 403.
  at tests\Feature\Admin\AdminAnnouncementTest.php:51
     47▕         ->post('/admin/announcements', [
     48▕             'title' => 'Hack Attempt',
     49▕             'content' => 'This should not work.',
     50▕         ])
  ➜  51▕         ->assertForbidden();
     52▕ });
     53▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminPostTest > admin can approve a pending p…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Admin\AdminPostTest.php:21
     17▕     $post = Post::factory()->resource()->create();
     18▕
     19▕     $this->actingAs($admin)
     20▕         ->post("/admin/posts/{$post->id}/approve")
  ➜  21▕         ->assertRedirect();
     22▕
     23▕     expect($post->fresh()->status->value)->toBe('approved');
     24▕ });
     25▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminPostTest > admin can delete a post
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Admin\AdminPostTest.php:32
     28▕     $post = Post::factory()->approved()->resource()->create();
     29▕
     30▕     $this->actingAs($admin)
     31▕         ->delete("/admin/posts/{$post->id}")
  ➜  32▕         ->assertRedirect();
     33▕
     34▕     $this->assertDatabaseMissing('posts', ['id' => $post->id]);
     35▕ });
     36▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminPostTest > non-admin cannot approve post…
  Expected response status code [403] but received 419.
Failed asserting that 419 is identical to 403.
  at tests\Feature\Admin\AdminPostTest.php:51
     47▕     $post = Post::factory()->resource()->create();
     48▕
     49▕     $this->actingAs($user)
     50▕         ->post("/admin/posts/{$post->id}/approve")
  ➜  51▕         ->assertForbidden();
     52▕ });
     53▕
     54▕ test('deleting a post removes its attachment file from storage', function () {
     55▕     Storage::fake('public');
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminPostTest > deleting a post removes its a…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Admin\AdminPostTest.php:68
     64▕     Storage::disk('public')->assertExists($filePath);
     65▕
     66▕     $this->actingAs($admin)
     67▕         ->delete("/admin/posts/{$post->id}")
  ➜  68▕         ->assertRedirect();
     69▕
     70▕     $this->assertDatabaseMissing('posts', ['id' => $post->id]);
     71▕     Storage::disk('public')->assertMissing($filePath);
     72▕ });
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminUserTest > admin can delete a user
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Admin\AdminUserTest.php:19
     15▕     $user = User::factory()->create();
     16▕
     17▕     $this->actingAs($admin)
     18▕         ->delete("/admin/users/{$user->id}")
  ➜  19▕         ->assertRedirect();
     20▕
     21▕     $this->assertDatabaseMissing('users', ['id' => $user->id]);
     22▕ });
     23▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminUserTest > admin cannot delete themselve…
  Expected response status code [403] but received 419.
Failed asserting that 419 is identical to 403.
  at tests\Feature\Admin\AdminUserTest.php:29
     25▕     $admin = User::factory()->admin()->create();
     26▕
     27▕     $this->actingAs($admin)
     28▕         ->delete("/admin/users/{$admin->id}")
  ➜  29▕         ->assertForbidden();
     30▕ });
     31▕
     32▕ test('admin can promote a user', function () {
     33▕     $admin = User::factory()->admin()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminUserTest > admin can promote a user
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Admin\AdminUserTest.php:38
     34▕     $user = User::factory()->create();
     35▕
     36▕     $this->actingAs($admin)
     37▕         ->post("/admin/users/{$user->id}/promote")
  ➜  38▕         ->assertRedirect();
     39▕
     40▕     expect($user->fresh()->role->value)->toBe('admin');
     41▕ });
     42▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminUserTest > admin can demote a user
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Admin\AdminUserTest.php:49
     45▕     $otherAdmin = User::factory()->admin()->create();
     46▕
     47▕     $this->actingAs($admin)
     48▕         ->post("/admin/users/{$otherAdmin->id}/demote")
  ➜  49▕         ->assertRedirect();
     50▕
     51▕     expect($otherAdmin->fresh()->role->value)->toBe('user');
     52▕ });
     53▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Admin\AdminUserTest > admin cannot demote themselve…
  Expected response status code [403] but received 419.
Failed asserting that 419 is identical to 403.
  at tests\Feature\Admin\AdminUserTest.php:59
     55▕     $admin = User::factory()->admin()->create();
     56▕
     57▕     $this->actingAs($admin)
     58▕         ->post("/admin/users/{$admin->id}/demote")
  ➜  59▕         ->assertForbidden();
     60▕ });
     61▕
     62▕ test('non-admin cannot access users list', function () {
     63▕     $user = User::factory()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthenticationTest > regular users are redirec…
  The user is not authenticated
Failed asserting that false is true.
  at tests\Feature\Auth\AuthenticationTest.php:20
     16▕         'email' => $user->email,
     17▕         'password' => 'password',
     18▕     ]);
     19▕
  ➜  20▕     $this->assertAuthenticated();
     21▕     $response->assertRedirect(route('dashboard'));
     22▕ });
     23▕
     24▕ test('admin users are redirected to admin dashboard after login', function () {
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthenticationTest > admin users are redirecte…
  The user is not authenticated
Failed asserting that false is true.
  at tests\Feature\Auth\AuthenticationTest.php:32
     28▕         'email' => $user->email,
     29▕         'password' => 'password',
     30▕     ]);
     31▕
  ➜  32▕     $this->assertAuthenticated();
     33▕     $response->assertRedirect('/admin');
     34▕ });
     35▕
     36▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthenticationTest > users can logout
  The user is authenticated
Failed asserting that true is false.
  at tests\Feature\Auth\AuthenticationTest.php:53
     49▕     $user = User::factory()->create();
     50▕
     51▕     $response = $this->actingAs($user)->post(route('logout'));
     52▕
  ➜  53▕     $this->assertGuest();
     54▕     $response->assertRedirect(route('home'));
     55▕ });
     56▕
     57▕ test('users are rate limited', function () {
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthenticationTest > users are rate limited
  Expected response status code [429] but received 419.
Failed asserting that 419 is identical to 429.
  at tests\Feature\Auth\AuthenticationTest.php:67
     63▕         'email' => $user->email,
     64▕         'password' => 'wrong-password',
     65▕     ]);
     66▕
  ➜  67▕     $response->assertTooManyRequests();
     68▕ });
     69▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\PasswordResetTest > reset password link can be…
  The expected [Illuminate\Auth\Notifications\ResetPassword] notification was not sent.
Failed asserting that false is true.
  at vendor\laravel\framework\src\Illuminate\Support\Testing\Fakes\NotificationFake.php:89
     85▕         if (is_numeric($callback)) {
     86▕             return $this->assertSentToTimes($notifiable, $notification, $callback);
     87▕         }
     88▕
  ➜  89▕         PHPUnit::assertTrue(
     90▕             $this->sent($notifiable, $notification, $callback)->count() > 0,
     91▕             "The expected [{$notification}] notification was not sent."
     92▕         );
     93▕     }
  1   vendor\laravel\framework\src\Illuminate\Support\Testing\Fakes\NotificationFake.php:89
  2   vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:363
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\PasswordResetTest > reset password screen can…
  The expected [Illuminate\Auth\Notifications\ResetPassword] notification was not sent.
Failed asserting that false is true.
  at vendor\laravel\framework\src\Illuminate\Support\Testing\Fakes\NotificationFake.php:89
     85▕         if (is_numeric($callback)) {
     86▕             return $this->assertSentToTimes($notifiable, $notification, $callback);
     87▕         }
     88▕
  ➜  89▕         PHPUnit::assertTrue(
     90▕             $this->sent($notifiable, $notification, $callback)->count() > 0,
     91▕             "The expected [{$notification}] notification was not sent."
     92▕         );
     93▕     }
  1   vendor\laravel\framework\src\Illuminate\Support\Testing\Fakes\NotificationFake.php:89
  2   vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:363
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\PasswordResetTest > password can be reset with…
  The expected [Illuminate\Auth\Notifications\ResetPassword] notification was not sent.
Failed asserting that false is true.
  at vendor\laravel\framework\src\Illuminate\Support\Testing\Fakes\NotificationFake.php:89
     85▕         if (is_numeric($callback)) {
     86▕             return $this->assertSentToTimes($notifiable, $notification, $callback);
     87▕         }
     88▕
  ➜  89▕         PHPUnit::assertTrue(
     90▕             $this->sent($notifiable, $notification, $callback)->count() > 0,
     91▕             "The expected [{$notification}] notification was not sent."
     92▕         );
     93▕     }
  1   vendor\laravel\framework\src\Illuminate\Support\Testing\Fakes\NotificationFake.php:89
  2   vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:363
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\PasswordResetTest > password cannot be reset w…
  Session is missing expected key [errors].
Failed asserting that false is true.
  at tests\Feature\Auth\PasswordResetTest.php:72
     68▕         'password' => 'newpassword123',
     69▕         'password_confirmation' => 'newpassword123',
     70▕     ]);
     71▕
  ➜  72▕     $response->assertSessionHasErrors('email');
     73▕ });
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\RegistrationTest > new users can register
  The user is not authenticated
Failed asserting that false is true.
  at tests\Feature\Auth\RegistrationTest.php:17
     13▕         'password' => 'password',
     14▕         'password_confirmation' => 'password',
     15▕     ]);
     16▕
  ➜  17▕     $this->assertAuthenticated();
     18▕     $response->assertRedirect(route('dashboard', absolute: false));
     19▕ });
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\VerificationNotificationTest > sends verificat…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Auth\VerificationNotificationTest.php:14
     10▕     $user = User::factory()->unverified()->create();
     11▕
     12▕     $this->actingAs($user)
     13▕         ->post(route('verification.send'))
  ➜  14▕         ->assertRedirect(route('home'));
     15▕
     16▕     Notification::assertSentTo($user, VerifyEmail::class);
     17▕ });
     18▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\VerificationNotificationTest > does not send v…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Auth\VerificationNotificationTest.php:26
     22▕     $user = User::factory()->create();
     23▕
     24▕     $this->actingAs($user)
     25▕         ->post(route('verification.send'))
  ➜  26▕         ->assertRedirect(route('dashboard', absolute: false));
     27▕
     28▕     Notification::assertNothingSent();
     29▕ });
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\CommentTest > users can add a comment to an approve…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\CommentTest.php:15
     11▕     $this->actingAs($user)
     12▕         ->post("/posts/{$post->id}/comments", [
     13▕             'comment' => 'Great resource!',
     14▕         ])
  ➜  15▕         ->assertRedirect();
     16▕
     17▕     $this->assertDatabaseHas('comments', [
     18▕         'post_id' => $post->id,
     19▕         'user_id' => $user->id,
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\CommentTest > users can delete their own comments
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\CommentTest.php:30
     26▕     $comment = Comment::factory()->create(['user_id' => $user->id]);
     27▕
     28▕     $this->actingAs($user)
     29▕         ->delete("/comments/{$comment->id}")
  ➜  30▕         ->assertRedirect();
     31▕
     32▕     $this->assertDatabaseMissing('comments', ['id' => $comment->id]);
     33▕ });
     34▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\CommentTest > users cannot delete other users comme…
  Expected response status code [403] but received 419.
Failed asserting that 419 is identical to 403.
  at tests\Feature\CommentTest.php:41
     37▕     $comment = Comment::factory()->create();
     38▕
     39▕     $this->actingAs($user)
     40▕         ->delete("/comments/{$comment->id}")
  ➜  41▕         ->assertForbidden();
     42▕ });
     43▕
     44▕ test('admins can delete any comment', function () {
     45▕     $admin = User::factory()->admin()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\CommentTest > admins can delete any comment
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\CommentTest.php:50
     46▕     $comment = Comment::factory()->create();
     47▕
     48▕     $this->actingAs($admin)
     49▕         ->delete("/comments/{$comment->id}")
  ➜  50▕         ->assertRedirect();
     51▕
     52▕     $this->assertDatabaseMissing('comments', ['id' => $comment->id]);
     53▕ });
     54▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\LikeTest > guests cannot toggle likes
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\LikeTest.php:10
      6▕ test('guests cannot toggle likes', function () {
      7▕     $post = Post::factory()->approved()->create();
      8▕
      9▕     $this->post("/posts/{$post->id}/like")
  ➜  10▕         ->assertRedirect(route('login'));
     11▕ });
     12▕
     13▕ test('users can like a post', function () {
     14▕     $user = User::factory()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\LikeTest > users can like a post
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\LikeTest.php:19
     15▕     $post = Post::factory()->approved()->create();
     16▕
     17▕     $this->actingAs($user)
     18▕         ->post("/posts/{$post->id}/like")
  ➜  19▕         ->assertRedirect();
     20▕
     21▕     $this->assertDatabaseHas('likes', [
     22▕         'post_id' => $post->id,
     23▕         'user_id' => $user->id,
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\LikeTest > users can unlike a post by toggling
  Failed asserting that a row in the table [likes] matches the attributes {
    "post_id": 13,
    "user_id": 60
}.
The table is empty.
  at tests\Feature\LikeTest.php:34
     30▕
     31▕     // Like first
     32▕     $this->actingAs($user)->post("/posts/{$post->id}/like");
     33▕
  ➜  34▕     $this->assertDatabaseHas('likes', [
     35▕         'post_id' => $post->id,
     36▕         'user_id' => $user->id,
     37▕     ]);
     38▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > guests can view an approved post
  Expected response status code [>=200, <300] but received 404.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:23
     19▕
     20▕ test('guests can view an approved post', function () {
     21▕     $post = Post::factory()->approved()->resource()->create();
     22▕
  ➜  23▕     $this->get("/posts/{$post->id}")->assertSuccessful();
     24▕ });
     25▕
     26▕ test('guests cannot view a pending post', function () {
     27▕     $post = Post::factory()->resource()->create(); // pending by default
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > guests cannot view a pending post
  Expected response status code [403] but received 404.
Failed asserting that 404 is identical to 403.
  at tests\Feature\PostTest.php:29
     25▕
     26▕ test('guests cannot view a pending post', function () {
     27▕     $post = Post::factory()->resource()->create(); // pending by default
     28▕
  ➜  29▕     $this->get("/posts/{$post->id}")->assertForbidden();
     30▕ });
     31▕
     32▕ test('guests are redirected to login when accessing post create page', function () {
     33▕     $this->get('/posts/create')->assertRedirect(route('login'));
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > guests are redirected to login when subm…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:41
     37▕     $this->post('/posts', [
     38▕         'title' => 'Unauthorized',
     39▕         'content' => 'Content here.',
     40▕         'type' => 'resource',
  ➜  41▕     ])->assertRedirect(route('login'));
     42▕ });
     43▕
     44▕ test('guests are redirected to login when commenting', function () {
     45▕     $post = Post::factory()->approved()->resource()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > guests are redirected to login when comm…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:49
     45▕     $post = Post::factory()->approved()->resource()->create();
     46▕
     47▕     $this->post("/posts/{$post->id}/comments", [
     48▕         'comment' => 'Hello',
  ➜  49▕     ])->assertRedirect(route('login'));
     50▕ });
     51▕
     52▕ test('users can view approved resources', function () {
     53▕     $user = User::factory()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > users can create a post with pending sta…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:87
     83▕             'title' => 'My Resource',
     84▕             'content' => 'Great content here.',
     85▕             'type' => 'resource',
     86▕         ])
  ➜  87▕         ->assertRedirect(route('dashboard'));
     88▕
     89▕     $this->assertDatabaseHas('posts', [
     90▕         'title' => 'My Resource',
     91▕         'status' => 'pending',
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > users can view a single approved post
  Expected response status code [>=200, <300] but received 404.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:102
     98▕     $post = Post::factory()->approved()->resource()->create();
     99▕
    100▕     $this->actingAs($user)
    101▕         ->get("/posts/{$post->id}")
  ➜ 102▕         ->assertSuccessful();
    103▕ });
    104▕
    105▕ test('users cannot view other users pending posts', function () {
    106▕     $user = User::factory()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > users cannot view other users pending po…
  Expected response status code [403] but received 404.
Failed asserting that 404 is identical to 403.
  at tests\Feature\PostTest.php:111
    107▕     $post = Post::factory()->resource()->create(); // pending by default
    108▕
    109▕     $this->actingAs($user)
    110▕         ->get("/posts/{$post->id}")
  ➜ 111▕         ->assertForbidden();
    112▕ });
    113▕
    114▕ test('users can view their own pending posts', function () {
    115▕     $user = User::factory()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > users can view their own pending posts
  Expected response status code [>=200, <300] but received 404.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:120
    116▕     $post = Post::factory()->resource()->create(['user_id' => $user->id]);
    117▕
    118▕     $this->actingAs($user)
    119▕         ->get("/posts/{$post->id}")
  ➜ 120▕         ->assertSuccessful();
    121▕ });
    122▕
    123▕ test('post creation requires title and content', function () {
    124▕     $user = User::factory()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > post creation requires title and content
  Session is missing expected key [errors].
Failed asserting that false is true.
  at tests\Feature\PostTest.php:132
    128▕             'title' => '',
    129▕             'content' => '',
    130▕             'type' => 'resource',
    131▕         ])
  ➜ 132▕         ->assertSessionHasErrors(['title', 'content']);
    133▕ });
    134▕
    135▕ test('users can create a post with an image attachment', function () {
    136▕     Storage::fake('public');
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > users can create a post with an image at…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:148
    144▕             'content' => 'Has an image.',
    145▕             'type' => 'resource',
    146▕             'attachment' => $file,
    147▕         ])
  ➜ 148▕         ->assertRedirect(route('dashboard'));
    149▕
    150▕     $post = Post::where('title', 'Post with Image')->first();
    151▕
    152▕     expect($post->file_path)->not->toBeNull();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > users can create a post with a pdf attac…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:170
    166▕             'content' => 'Has a PDF.',
    167▕             'type' => 'resource',
    168▕             'attachment' => $file,
    169▕         ])
  ➜ 170▕         ->assertRedirect(route('dashboard'));
    171▕
    172▕     $post = Post::where('title', 'Post with PDF')->first();
    173▕
    174▕     expect($post->file_path)->not->toBeNull();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > users can create a post without an attac…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\PostTest.php:188
    184▕             'title' => 'No Attachment',
    185▕             'content' => 'Just text.',
    186▕             'type' => 'resource',
    187▕         ])
  ➜ 188▕         ->assertRedirect(route('dashboard'));
    189▕
    190▕     $post = Post::where('title', 'No Attachment')->first();
    191▕
    192▕     expect($post->file_path)->toBeNull();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > attachment upload rejects files larger t…
  Session is missing expected key [errors].
Failed asserting that false is true.
  at tests\Feature\PostTest.php:210
    206▕             'content' => 'Big file.',
    207▕             'type' => 'resource',
    208▕             'attachment' => $file,
    209▕         ])
  ➜ 210▕         ->assertSessionHasErrors('attachment');
    211▕ });
    212▕
    213▕ test('attachment upload rejects invalid file types', function () {
    214▕     Storage::fake('public');
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\PostTest > attachment upload rejects invalid file t…
  Session is missing expected key [errors].
Failed asserting that false is true.
  at tests\Feature\PostTest.php:226
    222▕             'content' => 'Invalid file.',
    223▕             'type' => 'resource',
    224▕             'attachment' => $file,
    225▕         ])
  ➜ 226▕         ->assertSessionHasErrors('attachment');
    227▕ });
    228▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProjectTest > guests can view an approved project p…
  Expected response status code [>=200, <300] but received 404.
Failed asserting that false is true.
  at tests\Feature\ProjectTest.php:15
     11▕
     12▕ test('guests can view an approved project post', function () {
     13▕     $post = Post::factory()->approved()->project()->create();
     14▕
  ➜  15▕     $this->get("/posts/{$post->id}")->assertSuccessful();
     16▕ });
     17▕
     18▕ test('guests are redirected to login when submitting a project', function () {
     19▕     $this->post('/posts', [
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProjectTest > guests are redirected to login when s…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\ProjectTest.php:24
     20▕         'title' => 'My Project',
     21▕         'content' => 'A cool project.',
     22▕         'type' => 'project',
     23▕         'github_url' => 'https://github.com/user/repo',
  ➜  24▕     ])->assertRedirect(route('login'));
     25▕ });
     26▕
     27▕ test('users can create a project with a github url', function () {
     28▕     $user = User::factory()->create();
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProjectTest > users can create a project with a git…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\ProjectTest.php:37
     33▕             'content' => 'A cool project.',
     34▕             'type' => 'project',
     35▕             'github_url' => 'https://github.com/user/repo',
     36▕         ])
  ➜  37▕         ->assertRedirect(route('dashboard'));
     38▕
     39▕     $this->assertDatabaseHas('posts', [
     40▕         'title' => 'My Project',
     41▕         'type' => 'project',
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProjectTest > users can create a project without a…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\ProjectTest.php:56
     52▕             'title' => 'No GitHub Project',
     53▕             'content' => 'A project without a repo link.',
     54▕             'type' => 'project',
     55▕         ])
  ➜  56▕         ->assertRedirect(route('dashboard'));
     57▕
     58▕     $this->assertDatabaseHas('posts', [
     59▕         'title' => 'No GitHub Project',
     60▕         'github_url' => null,
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProjectTest > github url must be a valid url
  Session is missing expected key [errors].
Failed asserting that false is true.
  at tests\Feature\ProjectTest.php:74
     70▕             'content' => 'Content here.',
     71▕             'type' => 'project',
     72▕             'github_url' => 'not-a-url',
     73▕         ])
  ➜  74▕         ->assertSessionHasErrors('github_url');
     75▕ });
     76▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Settings\PasswordUpdateTest > password can be updat…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Settings\PasswordUpdateTest.php:30
     26▕         ]);
     27▕
     28▕     $response
     29▕         ->assertSessionHasNoErrors()
  ➜  30▕         ->assertRedirect(route('user-password.edit'));
     31▕
     32▕     expect(Hash::check('new-password', $user->refresh()->password))->toBeTrue();
     33▕ });
     34▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Settings\PasswordUpdateTest > correct password must…
  Session is missing expected key [errors].
Failed asserting that false is true.
  at tests\Feature\Settings\PasswordUpdateTest.php:48
     44▕             'password_confirmation' => 'new-password',
     45▕         ]);
     46▕
     47▕     $response
  ➜  48▕         ->assertSessionHasErrors('current_password')
     49▕         ->assertRedirect(route('user-password.edit'));
     50▕ });
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Settings\ProfileUpdateTest > profile information ca…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Settings\ProfileUpdateTest.php:27
     23▕         ]);
     24▕
     25▕     $response
     26▕         ->assertSessionHasNoErrors()
  ➜  27▕         ->assertRedirect(route('profile.edit'));
     28▕
     29▕     $user->refresh();
     30▕
     31▕     expect($user->name)->toBe('Test User');
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Settings\ProfileUpdateTest > email verification sta…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Settings\ProfileUpdateTest.php:48
     44▕         ]);
     45▕
     46▕     $response
     47▕         ->assertSessionHasNoErrors()
  ➜  48▕         ->assertRedirect(route('profile.edit'));
     49▕
     50▕     expect($user->refresh()->email_verified_at)->not->toBeNull();
     51▕ });
     52▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Settings\ProfileUpdateTest > user can delete their…
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\Settings\ProfileUpdateTest.php:64
     60▕         ]);
     61▕
     62▕     $response
     63▕         ->assertSessionHasNoErrors()
  ➜  64▕         ->assertRedirect(route('home'));
     65▕
     66▕     $this->assertGuest();
     67▕     expect($user->fresh())->toBeNull();
     68▕ });
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Settings\ProfileUpdateTest > correct password must…
  Session is missing expected key [errors].
Failed asserting that false is true.
  at tests\Feature\Settings\ProfileUpdateTest.php:81
     77▕             'password' => 'wrong-password',
     78▕         ]);
     79▕
     80▕     $response
  ➜  81▕         ->assertSessionHasErrors('password')
     82▕         ->assertRedirect(route('profile.edit'));
     83▕
     84▕     expect($user->fresh())->not->toBeNull();
     85▕ });
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\SuggestionTest > users can submit a suggestion
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\SuggestionTest.php:20
     16▕     $this->actingAs($user)
     17▕         ->post('/suggestions', [
     18▕             'message' => 'Please add dark mode.',
     19▕         ])
  ➜  20▕         ->assertRedirect();
     21▕
     22▕     $this->assertDatabaseHas('suggestions', [
     23▕         'user_id' => $user->id,
     24▕         'message' => 'Please add dark mode.',
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\SuggestionTest > suggestion requires a message
  Session is missing expected key [errors].
Failed asserting that false is true.
  at tests\Feature\SuggestionTest.php:33
     29▕     $user = User::factory()->create();
     30▕
     31▕     $this->actingAs($user)
     32▕         ->post('/suggestions', ['message' => ''])
  ➜  33▕         ->assertSessionHasErrors(['message']);
     34▕ });
     35▕
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\TagTest > users can create a post with tags
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\TagTest.php:17
     13▕             'content' => 'Content with tags.',
     14▕             'type' => 'resource',
     15▕             'tags' => 'react, typescript, tailwind',
     16▕         ])
  ➜  17▕         ->assertRedirect(route('dashboard'));
     18▕
     19▕     $post = Post::where('title', 'Tagged Post')->first();
     20▕
     21▕     expect($post->tags)->toHaveCount(3);
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\TagTest > tags are limited to 5
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\TagTest.php:35
     31▕             'content' => 'Testing tag limit.',
     32▕             'type' => 'resource',
     33▕             'tags' => 'one, two, three, four, five, six, seven',
     34▕         ])
  ➜  35▕         ->assertRedirect(route('dashboard'));
     36▕
     37▕     $post = Post::where('title', 'Many Tags')->first();
     38▕
     39▕     expect($post->tags)->toHaveCount(5);
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\TagTest > tags are created as lowercase
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\TagTest.php:52
     48▕             'content' => 'Testing case.',
     49▕             'type' => 'resource',
     50▕             'tags' => 'React, TypeScript',
     51▕         ])
  ➜  52▕         ->assertRedirect(route('dashboard'));
     53▕
     54▕     $this->assertDatabaseHas('tags', ['name' => 'react']);
     55▕     $this->assertDatabaseHas('tags', ['name' => 'typescript']);
     56▕ });
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\TagTest > duplicate tags are reused
  Expected response status code [201, 301, 302, 303, 307, 308] but received 419.
Failed asserting that false is true.
  at tests\Feature\TagTest.php:70
     66▕             'content' => 'Testing reuse.',
     67▕             'type' => 'resource',
     68▕             'tags' => 'react, vue',
     69▕         ])
  ➜  70▕         ->assertRedirect(route('dashboard'));
     71▕
     72▕     expect(Tag::where('name', 'react')->count())->toBe(1);
     73▕     expect(Tag::count())->toBe(2);
     74▕ });
  Tests:    61 failed, 37 passed (128 assertions)
  Duration: 435.13s
